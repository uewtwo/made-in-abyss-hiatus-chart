name: Create and Merge PR
description: GitHub Action to create and merge pull requests
runs:
  using: "composite"
  steps:
    - name: Push Branch
      shell: bash
      run: |
        git config user.name  "github-actions[bot]"
        git config user.email "github-actions[bot]@users.noreply.github.com"
        COMMIT_MESSAGE=`git status --porcelain`
        git switch -c update-hiatus-data
        git status
        git branch
        git add .
        git commit -m $COMMIT_MESSAGE
        git push --set-upstream origin update-hiatus-data
    - name: Create and Merge PR
      shell: bash
      run: |
        gh pr create --base main --head update-hiatus-data --title "Update Hiatus Data" --body "generated by github actions[bog]"
        gp pr merge update-hiatus-data --merge --auto --delete
        git fetch origin --prune
      env:
        GM_TOKEN: ${{ env.GITHUB_TOKEN }}
    # - name: Create Pull Request
    #   id: create_pr
    #   uses: peter-evans/create-pull-request@v6
    #   with:
    #     branch: update-hiatus-data
    #     base: main
    #     title: Update hiatus data
    #     delete-branch: false
