name: Create and Merge PR
description: GitHub Action to create and merge pull requests
inputs:
  branch_name:
    description: based branch used to merge
    required: true
runs:
  using: "composite"
  steps:
    - name: Push Branch
      shell: bash
      run: |
        echo ${{ inputs.branch_name }}
        git config user.name  "github-actions[bot]"
        git config user.email "github-actions[bot]@users.noreply.github.com"
        commit_message=`git status --porcelain`
        git switch -c ${{ inputs.branch_name }}
        git add .
        git commit -m "$commit_message"
        git push --set-upstream origin ${{ inputs.branch_name }} --force
    - name: Create and Merge PR
      shell: bash
      run: |
        gh pr create --base main \
          --head ${{ inputs.branch_name }} \
          --title "Update Hiatus Data" \
          --body "generated by github actions[bot]"
        gh pr merge ${{ inputs.branch_name }} --merge --auto --delete-branch
